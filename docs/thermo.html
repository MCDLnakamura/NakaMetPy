

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>thermo module &mdash; NakaMetPy 0.2.7 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="kinematics module" href="kinematics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> NakaMetPy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="kinematics.html">kinematics module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">thermo module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NakaMetPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>thermo module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/thermo.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-thermo">
<span id="thermo-module"></span><h1>thermo module<a class="headerlink" href="#module-thermo" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="thermo.density">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">mixing_ratio</span></em>, <em class="sig-param"><span class="n">molecular_weight_ratio</span><span class="o">=</span><span class="default_value">0.622</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate density.</p>
<p>This calculation must be given an air parcel’s pressure, temperature, and mixing ratio.
The implementation uses the formula outlined in <span id="id1">[Hobbs2006]</span> pg.67.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature</p></li>
<li><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – dimensionless mass mixing ratio</p></li>
<li><p><strong>molecular_weight_ratio</strong> (<cite>numpy.ndarray</cite> or float, optional) – The ratio of the molecular weight of the constituent gas to that assumed
for air. Defaults to the ratio for water vapor to dry air.
(<span class="math notranslate nohighlight">\(\epsilon\approx0.622\)</span>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding density of the parcel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="math notranslate nohighlight">
\[\rho = \frac{p}{R_dT_v}\]</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.dewpoint">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">dewpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">e</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.dewpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the ambient dewpoint given the vapor pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>e</strong> (<cite>numpy.ndarray</cite>) – Water vapor partial pressure</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dewpoint temperature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.dewpoint_from_relative_humidity" title="thermo.dewpoint_from_relative_humidity"><code class="xref py py-func docutils literal notranslate"><span class="pre">dewpoint_from_relative_humidity()</span></code></a>, <a class="reference internal" href="#thermo.saturation_vapor_pressure" title="thermo.saturation_vapor_pressure"><code class="xref py py-func docutils literal notranslate"><span class="pre">saturation_vapor_pressure()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">vapor_pressure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>This function inverts the <span id="id2">[Bolton1980]</span> formula for saturation vapor
pressure to instead calculate the temperature. This yield the following
formula for dewpoint in degrees Celsius:</p>
<div class="math notranslate nohighlight">
\[T = \frac{243.5 \log(e / 6.112)}{17.67 - \log(e / 6.112)}\]</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.dewpoint_from_relative_humidity">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">dewpoint_from_relative_humidity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">rh</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.dewpoint_from_relative_humidity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the ambient dewpoint given air temperature and relative humidity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature</p></li>
<li><p><strong>rh</strong> (<cite>numpy.ndarray</cite>) – relative humidity expressed as a ratio in the range 0 &lt; rh &lt;= 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dewpoint temperature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.dewpoint" title="thermo.dewpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">dewpoint()</span></code></a>, <a class="reference internal" href="#thermo.saturation_vapor_pressure" title="thermo.saturation_vapor_pressure"><code class="xref py py-func docutils literal notranslate"><span class="pre">saturation_vapor_pressure()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.dewpoint_from_specific_humidity">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">dewpoint_from_specific_humidity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">specific_humidity</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.dewpoint_from_specific_humidity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the dewpoint from specific humidity, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature</p></li>
<li><p><strong>specific_humidity</strong> (<cite>numpy.ndarray</cite>) – Specific humidity of air</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dew point temperature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.0: </span>Changed signature from <code class="docutils literal notranslate"><span class="pre">(specific_humidity,</span> <span class="pre">temperature,</span> <span class="pre">pressure)</span></code></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.relative_humidity_from_mixing_ratio" title="thermo.relative_humidity_from_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">relative_humidity_from_mixing_ratio()</span></code></a>, <a class="reference internal" href="#thermo.dewpoint_from_relative_humidity" title="thermo.dewpoint_from_relative_humidity"><code class="xref py py-func docutils literal notranslate"><span class="pre">dewpoint_from_relative_humidity()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.equivalent_potential_temperature">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">equivalent_potential_temperature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">dewpoint</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.equivalent_potential_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate equivalent potential temperature.</p>
<p>This calculation must be given an air parcel’s pressure, temperature, and dewpoint.
The implementation uses the formula outlined in <span id="id3">[Bolton1980]</span>:</p>
<p>First, the LCL temperature is calculated:</p>
<div class="math notranslate nohighlight">
\[T_{L}=\frac{1}{\frac{1}{T_{D}-56}+\frac{ln(T_{K}/T_{D})}{800}}+56\]</div>
<p>Which is then used to calculate the potential temperature at the LCL:</p>
<div class="math notranslate nohighlight">
\[\theta_{DL}=T_{K}\left(\frac{1000}{p-e}\right)^\kappa
\left(\frac{T_{K}}{T_{L}}\right)^{0.28r}\]</div>
<p>Both of these are used to calculate the final equivalent potential temperature:</p>
<div class="math notranslate nohighlight">
\[\theta_{E}=\theta_{DL}\exp\left[\left(\frac{3036.}{T_{L}}
-1.78\right)\times r(1+0.448r)\right]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Temperature of parcel</p></li>
<li><p><strong>dewpoint</strong> (<cite>numpy.ndarray</cite>) – Dewpoint of parcel</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The equivalent potential temperature of the parcel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><span id="id4">[Bolton1980]</span> formula for Theta-e is used, since according to
<span id="id5">[DaviesJones2009]</span> it is the most accurate non-iterative formulation
available.</p>
</dd></dl>

<dl class="py function">
<dt id="thermo.exner_function">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">exner_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">reference_pressure</span><span class="o">=</span><span class="default_value">100000</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.exner_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Exner function.</p>
<div class="math notranslate nohighlight">
\[\Pi = \left( \frac{p}{p_0} \right)^\kappa\]</div>
<p>This can be used to calculate potential temperature from temperature (and visa-versa),
since</p>
<div class="math notranslate nohighlight">
\[\Pi = \frac{T}{\theta}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – total atmospheric pressure</p></li>
<li><p><strong>reference_pressure</strong> (<cite>numpy.ndarray</cite>, optional) – The reference pressure against which to calculate the Exner function, defaults to
metpy.constants.P0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the Exner function at the given pressure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.potential_temperature" title="thermo.potential_temperature"><code class="xref py py-func docutils literal notranslate"><span class="pre">potential_temperature()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">temperature_from_potential_temperature()</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.k_index_2d">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">k_index_2d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t850</span></em>, <em class="sig-param"><span class="n">t700</span></em>, <em class="sig-param"><span class="n">t500</span></em>, <em class="sig-param"><span class="n">rh850</span></em>, <em class="sig-param"><span class="n">rh700</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.k_index_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>相対湿度、気温(およびリファレンスのための気圧)からK指数を計算する。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Pressure level value</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature</p></li>
<li><p><strong>rh</strong> (<cite>numpy.ndarray</cite>) – Dimensionless relative humidity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>K Index in Kelvin</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula based on that from [George1960]</p>
<div class="math notranslate nohighlight">
\[KI = T_{850} - T_{500} + Td_{850} - \left(T_{700} - Td_{700}\right)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(KI\)</span> is K index</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature</p></li>
<li><p><span class="math notranslate nohighlight">\(Td\)</span> is dew-point temperature</p></li>
</ul>
<p>Subscript means its pressure level</p>
</dd></dl>

<dl class="py function">
<dt id="thermo.k_index_3d">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">k_index_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">rh</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.k_index_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>相対湿度、気温(およびリファレンスのための気圧)からK指数を計算する。</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Pressure level value</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature</p></li>
<li><p><strong>rh</strong> (<cite>numpy.ndarray</cite>) – Dimensionless relative humidity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>K index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula based on that from [George1960]</p>
<div class="math notranslate nohighlight">
\[KI = T_{850} - T_{500} + Td_{850} - \left(T_{700} - Td_{700}\right)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(KI\)</span> is K index</p></li>
<li><p><span class="math notranslate nohighlight">\(T\)</span> is temperature</p></li>
<li><p><span class="math notranslate nohighlight">\(Td\)</span> is dew-point temperature</p></li>
</ul>
<p>Subscript means its pressure level</p>
</dd></dl>

<dl class="py function">
<dt id="thermo.mixing_ratio">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">part_press</span></em>, <em class="sig-param"><span class="n">tot_press</span></em>, <em class="sig-param"><span class="n">molecular_weight_ratio</span><span class="o">=</span><span class="default_value">0.622</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mixing ratio of a gas.</p>
<p>This calculates mixing ratio given its partial pressure and the total pressure of
the air. There are no required units for the input arrays, other than that
they have the same units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>part_press</strong> (<cite>numpy.ndarray</cite>) – Partial pressure of the constituent gas</p></li>
<li><p><strong>tot_press</strong> (<cite>numpy.ndarray</cite>) – Total air pressure</p></li>
<li><p><strong>molecular_weight_ratio</strong> (<cite>numpy.ndarray</cite> or float, optional) – The ratio of the molecular weight of the constituent gas to that assumed
for air. Defaults to the ratio for water vapor to dry air
(<span class="math notranslate nohighlight">\(\epsilon\approx0.622\)</span>).
水の分子量と空気の平均の分子量の比=18/28.8</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The (mass) mixing ratio, dimensionless (e.g. Kg/Kg or g/g)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is a straightforward implementation of the equation given in many places,
such as <span id="id6">[Hobbs1977]</span> pg.73:</p>
<div class="math notranslate nohighlight">
\[r = \epsilon \frac{e}{p - e}\]</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.saturation_mixing_ratio" title="thermo.saturation_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">saturation_mixing_ratio()</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">vapor_pressure()</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.mixing_ratio_from_relative_humidity">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">mixing_ratio_from_relative_humidity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">relative_humidity</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">pressure</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.mixing_ratio_from_relative_humidity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mixing ratio from relative humidity, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>relative_humidity</strong> (<cite>numpy.ndarray</cite>) – Relative Humidity
相対湿度
値は(0, 1]である必要がある</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature
気温</p></li>
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure
全圧</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dimensionless mixing ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula adapted from <span id="id7">[Hobbs1977]</span> pg. 74.</p>
<div class="math notranslate nohighlight">
\[w = (RH)(w_s)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(RH\)</span> is relative humidity as a unitless ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(w_s\)</span> is the saturation mixing ratio</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.relative_humidity_from_mixing_ratio" title="thermo.relative_humidity_from_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">relative_humidity_from_mixing_ratio()</span></code></a>, <a class="reference internal" href="#thermo.saturation_mixing_ratio" title="thermo.saturation_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">saturation_mixing_ratio()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.mixing_ratio_from_specific_humidity">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">mixing_ratio_from_specific_humidity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">specific_humidity</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.mixing_ratio_from_specific_humidity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mixing ratio from specific humidity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>specific_humidity</strong> (<cite>numpy.ndarray</cite>) – Specific humidity of air</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mixing ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula from <span id="id8">[Salby1996]</span> pg. 118.</p>
<div class="math notranslate nohighlight">
\[w = \frac{q}{1-q}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is the specific humidity</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.mixing_ratio" title="thermo.mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">mixing_ratio()</span></code></a>, <a class="reference internal" href="#thermo.specific_humidity_from_mixing_ratio" title="thermo.specific_humidity_from_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">specific_humidity_from_mixing_ratio()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.potential_temperature">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">potential_temperature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.potential_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the potential temperature.</p>
<p>Uses the Poisson equation to calculation the potential temperature
given <cite>pressure</cite> and <cite>temperature</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The potential temperature corresponding to the temperature and
pressure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">dry_lapse()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>Formula:</p>
<div class="math notranslate nohighlight">
\[\Theta = T (P_0 / P)^\kappa\]</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">metpy.units</span> <span class="kn">import</span> <span class="n">units</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metpy</span><span class="o">.</span><span class="n">calc</span><span class="o">.</span><span class="n">potential_temperature</span><span class="p">(</span><span class="mf">800.</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">mbar</span><span class="p">,</span> <span class="mf">273.</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">kelvin</span><span class="p">)</span>
<span class="go">&lt;Quantity(290.966533, &#39;kelvin&#39;)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.relative_humidity_from_mixing_ratio">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">relative_humidity_from_mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">mixing_ratio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.relative_humidity_from_mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the relative humidity from mixing ratio, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature</p></li>
<li><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – Dimensionless mass mixing ratio</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Relative humidity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula based on that from <span id="id9">[Hobbs1977]</span> pg. 74.</p>
<div class="math notranslate nohighlight">
\[RH = \frac{w}{w_s}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(relative_humidity\)</span> is relative humidity as a unitless ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(w_s\)</span> is the saturation mixing ratio</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.mixing_ratio_from_relative_humidity" title="thermo.mixing_ratio_from_relative_humidity"><code class="xref py py-func docutils literal notranslate"><span class="pre">mixing_ratio_from_relative_humidity()</span></code></a>, <a class="reference internal" href="#thermo.saturation_mixing_ratio" title="thermo.saturation_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">saturation_mixing_ratio()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.relative_humidity_from_specific_humidity">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">relative_humidity_from_specific_humidity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pressure</span></em>, <em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">specific_humidity</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.relative_humidity_from_specific_humidity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the relative humidity from specific humidity, temperature, and pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – Air temperature</p></li>
<li><p><strong>specific_humidity</strong> (<cite>numpy.ndarray</cite>) – Specific humidity of air</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Relative humidity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula based on that from <span id="id10">[Hobbs1977]</span> pg. 74. and <span id="id11">[Salby1996]</span> pg. 118.</p>
<div class="math notranslate nohighlight">
\[RH = \frac{q}{(1-q)w_s}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(relative_humidity\)</span> is relative humidity as a unitless ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is specific humidity</p></li>
<li><p><span class="math notranslate nohighlight">\(w_s\)</span> is the saturation mixing ratio</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.relative_humidity_from_mixing_ratio" title="thermo.relative_humidity_from_mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">relative_humidity_from_mixing_ratio()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.saturation_mixing_ratio">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">saturation_mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tot_press</span></em>, <em class="sig-param"><span class="n">temperature</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.saturation_mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the saturation mixing ratio of water vapor.</p>
<p>This calculation is given total pressure and the temperature. The implementation
uses the formula outlined in <span id="id12">[Hobbs1977]</span> pg.73.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tot_press</strong> (<cite>numpy.ndarray</cite>) – Total atmospheric pressure</p></li>
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The saturation mixing ratio, dimensionless</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="thermo.saturation_vapor_pressure">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">saturation_vapor_pressure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.saturation_vapor_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the saturation water vapor (partial) pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The saturation water vapor (partial) pressure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">vapor_pressure()</span></code>, <a class="reference internal" href="#thermo.dewpoint" title="thermo.dewpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">dewpoint()</span></code></a></p>
</div>
<p class="rubric">Notes</p>
<p>Instead of temperature, dewpoint may be used in order to calculate
the actual (ambient) water vapor (partial) pressure.</p>
<p>The formula used is that from <span id="id13">[Bolton1980]</span> for T in degrees Celsius:</p>
<div class="math notranslate nohighlight">
\[6.112 e^\frac{17.67T}{T + 243.5}\]</div>
<p>下記の式は既にケルビンに直してある</p>
</dd></dl>

<dl class="py function">
<dt id="thermo.showalter_stability_index">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">showalter_stability_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t850</span></em>, <em class="sig-param"><span class="n">t500</span></em>, <em class="sig-param"><span class="n">p850</span></em>, <em class="sig-param"><span class="n">p500</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.showalter_stability_index" title="Permalink to this definition">¶</a></dt>
<dd><p>500hPaにおける気温から850 hPaから500 hPaに断熱変化させた際の気温を引いた指数。
この計算では乾燥断熱減率のみを考慮しているため、湿潤断熱変化も含めたSSIを
求める方法が必要である。</p>
<div class="math notranslate nohighlight">
\[SSI = T_{500} - T_{850\rightarrow 500}^*\]</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.specific_humidity_from_mixing_ratio">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">specific_humidity_from_mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mixing_ratio</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.specific_humidity_from_mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the specific humidity from the mixing ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – mixing ratio</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Specific humidity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Formula from <span id="id14">[Salby1996]</span> pg. 118.</p>
<div class="math notranslate nohighlight">
\[q = \frac{w}{1+w}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w\)</span> is mixing ratio</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span> is the specific humidity</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#thermo.mixing_ratio" title="thermo.mixing_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">mixing_ratio()</span></code></a>, <a class="reference internal" href="#thermo.mixing_ratio_from_specific_humidity" title="thermo.mixing_ratio_from_specific_humidity"><code class="xref py py-func docutils literal notranslate"><span class="pre">mixing_ratio_from_specific_humidity()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="thermo.virtual_temperature">
<code class="sig-prename descclassname">thermo.</code><code class="sig-name descname">virtual_temperature</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">temperature</span></em>, <em class="sig-param"><span class="n">mixing_ratio</span></em>, <em class="sig-param"><span class="n">molecular_weight_ratio</span><span class="o">=</span><span class="default_value">0.622</span></em><span class="sig-paren">)</span><a class="headerlink" href="#thermo.virtual_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate virtual temperature.</p>
<p>This calculation must be given an air parcel’s temperature and mixing ratio.
The implementation uses the formula outlined in <span id="id15">[Hobbs2006]</span> pg.80.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<cite>numpy.ndarray</cite>) – air temperature</p></li>
<li><p><strong>mixing_ratio</strong> (<cite>numpy.ndarray</cite>) – dimensionless mass mixing ratio</p></li>
<li><p><strong>molecular_weight_ratio</strong> (<cite>numpy.ndarray</cite> or float, optional) – The ratio of the molecular weight of the constituent gas to that assumed
for air. Defaults to the ratio for water vapor to dry air.
(<span class="math notranslate nohighlight">\(\epsilon\approx0.622\)</span>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding virtual temperature of the parcel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="math notranslate nohighlight">
\[T_v = T \frac{\text{w} + \epsilon}{\epsilon\,(1 + \text{w})}\]</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="kinematics.html" class="btn btn-neutral float-left" title="kinematics module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Yuki Nakamura.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>